import{_ as V,l as z,c as n,F as x,r as L,a as U,n as S,b as a,m as p,I,o,V as J,f as D,s as F,x as X,W as H,X as k,w as N,t as w,G as O}from"./index-rvQoOiZL.js";const Q={key:0,class:"conversation-list-skeleton"},Y={key:1,class:"message-list-skeleton"},Z={class:"message-bubble-skeleton"},ee={key:0,class:"skeleton-text skeleton-text--short"},te={class:"skeleton-footer"},se={key:0,class:"skeleton-status"},ae={key:2,class:"inbox-header-skeleton"},ne={key:3,class:"conversation-header-skeleton"},oe={key:4,class:"search-bar-skeleton"},ie={key:5,class:"generic-skeleton"},le={__name:"ChatLoadingSkeleton",props:{type:{type:String,default:"generic",validator:l=>["conversation-list","message-list","inbox-header","conversation-header","search-bar","generic"].includes(l)},count:{type:Number,default:3},animated:{type:Boolean,default:!0},size:{type:String,default:"medium",validator:l=>["small","medium","large"].includes(l)}},setup(l){const C=l,u=z(()=>({"chat-loading-skeleton--animated":C.animated,[`chat-loading-skeleton--${C.size}`]:!0})),b=v=>{const r=["60%","80%","45%","90%","35%","70%"];return{width:r[v%r.length]}},$=v=>{const r=["100%","85%","92%","78%","95%"];return{width:r[v%r.length]}};return(v,r)=>(o(),n("div",{class:S(["chat-loading-skeleton",u.value])},[l.type==="conversation-list"?(o(),n("div",Q,[(o(!0),n(x,null,L(l.count,i=>(o(),n("div",{key:i,class:"conversation-item-skeleton"},r[0]||(r[0]=[U('<div class="skeleton-avatar" data-v-6fdf5df2></div><div class="skeleton-content" data-v-6fdf5df2><div class="skeleton-header" data-v-6fdf5df2><div class="skeleton-name" data-v-6fdf5df2></div><div class="skeleton-time" data-v-6fdf5df2></div></div><div class="skeleton-message" data-v-6fdf5df2></div></div>',2)])))),128))])):l.type==="message-list"?(o(),n("div",Y,[(o(!0),n(x,null,L(l.count,i=>(o(),n("div",{key:i,class:S(["message-skeleton",{"message-skeleton--own":i%3===0,"message-skeleton--other":i%3!==0}])},[a("div",Z,[a("div",{class:"skeleton-text",style:I(b(i))},null,4),i%2===0?(o(),n("div",ee)):p("",!0),a("div",te,[r[1]||(r[1]=a("div",{class:"skeleton-time"},null,-1)),i%3===0?(o(),n("div",se)):p("",!0)])])],2))),128))])):l.type==="inbox-header"?(o(),n("div",ae,r[2]||(r[2]=[U('<div class="skeleton-title" data-v-6fdf5df2></div><div class="skeleton-subtitle" data-v-6fdf5df2></div><div class="skeleton-actions" data-v-6fdf5df2><div class="skeleton-button" data-v-6fdf5df2></div><div class="skeleton-button skeleton-button--primary" data-v-6fdf5df2></div></div>',3)]))):l.type==="conversation-header"?(o(),n("div",ne,r[3]||(r[3]=[a("div",{class:"skeleton-avatar skeleton-avatar--large"},null,-1),a("div",{class:"skeleton-participant-info"},[a("div",{class:"skeleton-name skeleton-name--large"}),a("div",{class:"skeleton-status"})],-1)]))):l.type==="search-bar"?(o(),n("div",oe,r[4]||(r[4]=[a("div",{class:"skeleton-search-input"},null,-1),a("div",{class:"skeleton-filter-select"},null,-1),a("div",{class:"skeleton-sort-button"},null,-1)]))):(o(),n("div",ie,[(o(!0),n(x,null,L(l.count,i=>(o(),n("div",{key:i,class:"skeleton-line",style:I($(i))},null,4))),128))]))],2))}},re=V(le,[["__scopeId","data-v-6fdf5df2"]]),de={class:"chat-conversation-list"},ce={key:0,class:"conversation-loading"},ue={key:1,class:"conversation-empty"},ve={class:"empty-actions"},fe={key:2,class:"conversation-items"},ke=["onClick","onKeydown","aria-label"],he={class:"conversation-avatar"},me={class:"avatar-circle"},ge=["aria-label"],ye={class:"conversation-content"},we={class:"conversation-header"},pe={class:"participant-name"},Ce=["datetime","title"],be={class:"conversation-preview"},$e={class:"last-message"},_e=["aria-label"],Me={class:"conversation-actions"},xe=["onClick","aria-label"],Le=["onClick","aria-label"],Ne={__name:"ChatConversationList",props:{conversations:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["conversation-click","loading-error"],setup(l,{emit:C}){const u=l,b=C,$=J(),v=D(-1),r=D([]),i=z(()=>$.getConversationUnreadCount),h=e=>e.participantTwoName||e.otherParticipantName||e.participantName||"Unknown User",E=e=>{const t=h(e).split(" ");return t.length>=2?`${t[0][0]}${t[1][0]}`.toUpperCase():t.length===1?t[0].substring(0,2).toUpperCase():"UN"},P=e=>{var g,y;const s=h(e),t=i.value(e.id),d=((g=e.latestMessage)==null?void 0:g.content)||"No messages yet",f=A(((y=e.latestMessage)==null?void 0:y.createdAt)||e.updatedAt);let m=`Conversation with ${s}. Last message: ${d}. ${f}.`;return t>0&&(m+=` ${t} unread message${t>1?"s":""}.`),m},A=e=>{if(!e||new Date(e).getTime()===0)return"Invalid time";const s=new Date(e),d=Math.floor((new Date-s)/(1e3*60));return d<1?"Just now":d<60?`${d}m ago`:d<1440?`${Math.floor(d/60)}h ago`:d<10080?`${Math.floor(d/1440)}d ago`:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})},T=e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",_=async e=>{i.value(e.id)>0&&await B(e),b("conversation-click",e)},B=async e=>{try{await $.markConversationAsRead(e.id)}catch(s){console.error("Failed to mark conversation as read:",s)}},R=(e,s)=>{e&&(r.value[s]=e)},M=async e=>{if(e>=0&&e<u.conversations.length){v.value=e,await O();const s=r.value[e];s&&s.focus()}},j=async e=>{const s=e+1;s<u.conversations.length&&await M(s)},K=async e=>{const s=e-1;s>=0&&await M(s)},W=async()=>{u.conversations.length>0&&await M(0)},q=async()=>{u.conversations.length>0&&await M(u.conversations.length-1)},G=e=>{console.error("ChatConversationList loading error:",e),b("loading-error",e)};return(e,s)=>(o(),n("div",de,[l.loading&&l.conversations.length===0?(o(),n("div",ce,[F(H,{"error-title":"Loading Error","error-message":"Failed to load conversation list",retryable:!1,onError:G},{default:X(()=>[F(re,{type:"conversation-list",count:6,animated:!0})]),_:1})])):l.conversations.length===0?(o(),n("div",ue,[s[1]||(s[1]=a("svg",{class:"empty-icon",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),s[2]||(s[2]=a("h3",null,"No conversations yet",-1)),s[3]||(s[3]=a("p",null,"Start a conversation with a lawyer to see messages here",-1)),a("div",ve,[a("button",{onClick:s[0]||(s[0]=t=>e.$router.push("/find-lawyer")),class:"btn btn-primary"}," Find a Lawyer ")])])):(o(),n("div",fe,[(o(!0),n(x,null,L(l.conversations,(t,d)=>{var f,m,g,y;return o(),n("div",{key:t.id,class:S(["conversation-item",{"conversation-item--unread":i.value(t.id)>0,"conversation-item--focused":v.value===d}]),onClick:c=>_(t),role:"button",tabindex:"0",onKeydown:[k(c=>_(t),["enter"]),k(N(c=>_(t),["prevent"]),["space"]),k(c=>j(d),["down"]),k(c=>K(d),["up"]),k(W,["home"]),k(q,["end"])],"aria-label":P(t),ref_for:!0,ref:c=>R(c,d)},[a("div",he,[a("div",me,w(E(t)),1),i.value(t.id)>0?(o(),n("div",{key:0,class:"avatar-unread-indicator","aria-label":`${i.value(t.id)} unread messages`},null,8,ge)):p("",!0)]),a("div",ye,[a("div",we,[a("h4",pe,w(h(t)),1),a("time",{class:"conversation-time",datetime:((f=t.latestMessage)==null?void 0:f.createdAt)||t.updatedAt,title:T(((m=t.latestMessage)==null?void 0:m.createdAt)||t.updatedAt)},w(A(((g=t.latestMessage)==null?void 0:g.createdAt)||t.updatedAt)),9,Ce)]),a("div",be,[a("p",$e,w(((y=t.latestMessage)==null?void 0:y.content)||"No messages yet"),1),i.value(t.id)>0?(o(),n("div",{key:0,class:"unread-badge","aria-label":`${i.value(t.id)} unread messages`},w(i.value(t.id)>9?"9+":i.value(t.id)),9,_e)):p("",!0)])]),a("div",Me,[i.value(t.id)>0?(o(),n("button",{key:0,onClick:N(c=>B(t),["stop"]),class:"action-btn mark-read-btn","aria-label":`Mark conversation with ${h(t)} as read`,title:"Mark as read"},s[4]||(s[4]=[a("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M20 6L9 17l-5-5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,xe)):p("",!0),a("button",{onClick:N(c=>_(t),["stop"]),class:"action-btn view-btn","aria-label":`View conversation with ${h(t)}`,title:"View conversation"},s[5]||(s[5]=[a("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[a("path",{d:"M9 18l6-6-6-6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),8,Le)])],42,ke)}),128))]))]))}},Ae=V(Ne,[["__scopeId","data-v-bdfd3498"]]);export{re as C,Ae as a};
