import{i as b,a as G,b as I,F as N}from"./FullCalendar-BDqQaoRN.js";import{_ as S,f as l,l as w,A,D as h,c as s,b as n,g as L,a as m,t as B,d as O,m as R,C as P,J as V,B as x,o as r,G as T}from"./index-rvQoOiZL.js";const F={class:"my-calendar-section dashboard-card"},H={class:"card-header"},U={key:1,class:"google-calendar-connected"},$={class:"card-content"},j={key:0,class:"loading-state"},z={key:1,class:"error-state"},J={key:2,class:"calendar-container"},K={key:1,class:"calendar-placeholder"},W={__name:"MyCalendarSection",setup(q){const c=l([]),i=l(!1),v=l(""),d=l(null),p=l(0),y=l(!1),u=l(!1),g=async()=>{var e,t,o;i.value=!0,v.value="";try{const a=await V.getAllUserSchedules();c.value=((e=a.data)==null?void 0:e.schedules)||[]}catch(a){console.error("Error loading schedules:",a),v.value=((o=(t=a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to load schedules"}finally{i.value=!1}},D=async()=>{try{const e=await x.checkGoogleCalendarStatus();u.value=e.data}catch(e){console.error("Error checking Google Calendar status:",e),u.value=!1}},_=async()=>{try{const e=await x.authorizeGoogleCalendar();e.data&&(window.location.href=e.data)}catch(e){console.error("Error initiating Google Calendar authorization:",e),alert("Failed to connect Google Calendar. Please try again.")}},k=e=>({COURT_HEARING:"#92400e",CLIENT_MEETING:"#1e40af",DEADLINE:"#991b1b",OTHER:"#374151"})[e]||"#374151",E=e=>({COURT_HEARING:"Court Hearing",CLIENT_MEETING:"Client Meeting",DEADLINE:"Deadline",OTHER:"Other"})[e]||e,f=w(()=>c.value.map(e=>{var C;let t,o,a=!1;return e.startTime&&e.endTime?(t=new Date(e.startTime),o=new Date(e.endTime),a=!1):e.startTime?(t=new Date(e.startTime),o=new Date(new Date(e.startTime).getTime()+60*60*1e3),a=!1):(t=new Date(e.date),o=new Date(e.date+"T23:59:59"),a=!0),{id:e.id,title:e.title,start:t,end:o,allDay:a,backgroundColor:k(e.type),borderColor:k(e.type),textColor:"#ffffff",extendedProps:{type:e.type,typeDisplay:E(e.type),description:e.description,caseTitle:((C=e.caseInfo)==null?void 0:C.title)||"Unknown Case"}}})),M=w(()=>({plugins:[b,G,I],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},height:"auto",events:f.value,datesSet:e=>{console.log("Calendar dates set:",e)},eventClick:e=>{console.log("Event clicked:",e.event.extendedProps)},eventDidMount:e=>{const t=e.event,o=t.extendedProps.typeDisplay,a=t.extendedProps.description;a?e.el.title=`${o}: ${a}`:e.el.title=o},dayMaxEvents:!0,moreLinkClick:"popover",editable:!1,selectable:!1,selectMirror:!0,weekends:!0,firstDay:1,slotMinTime:"06:00:00",slotMaxTime:"22:00:00",allDaySlot:!0,slotDuration:"00:30:00",slotLabelInterval:"01:00:00",nowIndicator:!0,scrollTime:"08:00:00",expandRows:!0,aspectRatio:1.35,eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:"short"},eventDisplay:"block",eventOverlap:!1,slotEventOverlap:!1}));return A(()=>{y.value=!0,g(),D()}),h(f,()=>{d.value&&T(()=>{d.value.getApi().refetchEvents()})},{deep:!0}),h(i,(e,t)=>{t&&!e&&T(()=>{p.value++,d.value&&d.value.getApi().render()})}),(e,t)=>(r(),s("div",F,[n("div",H,[t[1]||(t[1]=n("h3",null,"My Calendar",-1)),u.value?(r(),s("span",U,t[0]||(t[0]=[n("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M22 11.08V12A10 10 0 1 1 5.68 3.57",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),n("path",{d:"M22 4L12 14.01L9 11.01",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),L(" Google Calendar Connected ")]))):(r(),s("button",{key:0,onClick:_,class:"btn btn-outline btn-sm"}," Connect Google Calendar "))]),n("div",$,[i.value?(r(),s("div",j,t[2]||(t[2]=[n("div",{class:"loading-spinner"},null,-1),n("p",null,"Loading calendar...",-1)]))):v.value?(r(),s("div",z,[t[3]||(t[3]=m('<div class="error-icon" data-v-a924157e><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a924157e><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" data-v-a924157e></circle><line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" data-v-a924157e></line><line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" data-v-a924157e></line></svg></div>',1)),n("p",null,B(v.value),1),n("button",{onClick:g,class:"btn btn-primary btn-sm"},"Try Again")])):(r(),s("div",J,[!i.value&&c.value.length>0&&y.value?(r(),O(P(N),{options:M.value,ref_key:"fullCalendar",ref:d,key:p.value},null,8,["options"])):!i.value&&c.value.length===0?(r(),s("div",K,t[4]||(t[4]=[m('<div class="placeholder-icon" data-v-a924157e><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-a924157e><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" data-v-a924157e></rect><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" data-v-a924157e></line><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" data-v-a924157e></line><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" data-v-a924157e></line></svg></div><p data-v-a924157e>No scheduled events found</p><span class="placeholder-note" data-v-a924157e>Schedule events will appear here</span>',3)]))):R("",!0)]))])]))}},Y=S(W,[["__scopeId","data-v-a924157e"]]);export{Y as M};
