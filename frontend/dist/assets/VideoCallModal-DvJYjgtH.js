import{_ as R,u as L,f as l,A as b,M as P,c as m,b as t,m as N,t as u,g as B,a as D,I as W,G as U,o as E}from"./index-rvQoOiZL.js";const V={class:"video-call-overlay"},j={class:"video-call-container"},J={class:"video-call-header"},F={class:"meeting-info"},G={key:0,class:"loading-container"},$={key:1,class:"error-container"},H={__name:"VideoCallModal",props:{meeting:{type:Object,required:!0},roomName:{type:String,required:!0}},emits:["close"],setup(A,{emit:T}){const c=A,O=T,_=L(),s=l(!0),r=l("");let i=null;const S=e=>e&&(`${e.firstName||""} ${e.lastName||""}`.trim()||e.email)||"Unknown Client",w=l(c.meeting.roomName||"Video Consultation"),h=l(`Meeting with ${S(c.meeting.client)}`),C=()=>{const e=_.userInfo;return e!=null&&e.firstName&&(e!=null&&e.lastName)?`${e.firstName} ${e.lastName}`:(e==null?void 0:e.firstName)||(e==null?void 0:e.email)||"User"},I=()=>{var e;return((e=_.userInfo)==null?void 0:e.email)||"user@example.com"},y=()=>new Promise((e,o)=>{if(window.JitsiMeetExternalAPI){e();return}const a=document.createElement("script");a.src="https://8x8.vc/vpaas-magic-cookie-0b2313ac61a749f09df6e9c27e20c190/external_api.js",a.async=!0,a.onload=()=>{setTimeout(e,100)},a.onerror=()=>{o(new Error("Failed to load Jitsi Meet API"))},document.head.appendChild(a)}),f=async()=>{try{s.value=!0,r.value="",await U(),await y();const o=await new Promise((n,x)=>{let p=0;const v=()=>{const g=document.querySelector("#jitsi-container");g?n(g):p<50?(p++,setTimeout(v,100)):x(new Error("Jitsi container element not found"))};v()}),a="8x8.vc",k={roomName:`vpaas-magic-cookie-0b2313ac61a749f09df6e9c27e20c190/${c.roomName}`,parentNode:o,userInfo:{displayName:C(),email:I()},configOverwrite:{startWithAudioMuted:!1,startWithVideoMuted:!1,enableWelcomePage:!1,prejoinPageEnabled:!1,disableModeratorIndicator:!1,startScreenSharing:!1,enableEmailInStats:!1},interfaceConfigOverwrite:{DISABLE_JOIN_LEAVE_NOTIFICATIONS:!1,DISABLE_PRESENCE_STATUS:!1,DISPLAY_WELCOME_PAGE_CONTENT:!1,ENABLE_FEEDBACK_ANIMATION:!1,FILMSTRIP_ENABLED:!0,GENERATE_ROOMNAMES_ON_WELCOME_PAGE:!1,HIDE_INVITE_MORE_HEADER:!1,JITSI_WATERMARK_LINK:"https://jitsi.org",LANG_DETECTION:!0,LIVE_STREAMING_ENABLED:!1,MOBILE_APP_PROMO:!1,RECENT_LIST_ENABLED:!0,REMOTE_VIDEO_MENU_BUTTON_ENABLED:!0,SETTINGS_SECTIONS:["devices","language","moderator","profile","calendar"],SHOW_BRAND_WATERMARK:!1,SHOW_JITSI_WATERMARK:!1,SHOW_POWERED_BY:!1,SHOW_PROMOTIONAL_CLOSE_PAGE:!1,SHOW_WATERMARK_FOR_GUESTS:!1,TOOLBAR_BUTTONS:["microphone","camera","closedcaptions","desktop","embedmeeting","fullscreen","fodeviceselection","hangup","profile","chat","recording","livestreaming","etherpad","sharedvideo","settings","raisehand","videoquality","filmstrip","invite","feedback","stats","shortcuts","tileview","videobackgroundblur","download","help","mute-everyone","security"],TOOLBAR_TIMEOUT:4e3,UNSUPPORTED_BROWSER:!1,VIDEO_LAYOUT_FIT:"both"}};i=new window.JitsiMeetExternalAPI(a,k),i.addEventListeners({readyToClose:()=>{d()},participantLeft:n=>{console.log("Participant left:",n)},participantJoined:n=>{console.log("Participant joined:",n)},videoConferenceJoined:n=>{console.log("Conference joined:",n),s.value=!1},videoConferenceLeft:()=>{console.log("Conference left"),d()}})}catch(e){console.error("Error initializing Jitsi Meet:",e),r.value=e.message||"Failed to initialize video call",s.value=!1}},M=()=>{f()},d=()=>{i&&(i.dispose(),i=null),O("close")};return b(()=>{f()}),P(()=>{i&&(i.dispose(),i=null)}),(e,o)=>(E(),m("div",V,[t("div",j,[t("div",J,[t("div",F,[t("h3",null,u(w.value),1),t("p",null,u(h.value),1)]),t("button",{onClick:d,class:"end-call-btn"},o[0]||(o[0]=[t("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),B(" End Call ")]))]),s.value?(E(),m("div",G,o[1]||(o[1]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Connecting to meeting...",-1)]))):N("",!0),r.value?(E(),m("div",$,[o[2]||(o[2]=D('<div class="error-icon" data-v-bc277c1a><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-bc277c1a><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" data-v-bc277c1a></circle><line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2" data-v-bc277c1a></line><line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2" data-v-bc277c1a></line></svg></div><h4 data-v-bc277c1a>Failed to join meeting</h4>',2)),t("p",null,u(r.value),1),t("button",{onClick:M,class:"btn btn-primary"}," Try Again ")])):N("",!0),t("div",{id:"jitsi-container",class:"jitsi-container",style:W({display:s.value||r.value?"none":"flex"})},null,4)])]))}},z=R(H,[["__scopeId","data-v-bc277c1a"]]);export{z as V};
