import{N as R,f as v,l as P,U as D}from"./index-rvQoOiZL.js";const z=R("case",()=>{const l=v([]),p=v(null),x=v(!1),C=v(null),E=v(0),I=v(0),m=v(10),w=v(null),S=v("DESC"),A=P(()=>l.value.length<E.value),L=P(()=>l.value.filter(e=>e.status==="IN_PROGRESS")),M=P(()=>l.value.filter(e=>e.status==="RESOLVED")),y=()=>{C.value=null},i=e=>{x.value=e},F=async(e=0,u=10,r=null,t="DESC",c=!1)=>{var o,a,s,n,d,f,h;i(!0),y();try{const B=((o=(await D.getAllUserCases(e,u,r,t)).data)==null?void 0:o.cases)||[];c||e===0?l.value=B:l.value=[...l.value,...B],E.value=B.length,I.value=e,m.value=u,w.value=r,S.value=t}catch(g){console.error("❌ Error fetching cases:",g),console.error("❌ Error response:",g.response),console.error("❌ Error response data:",(a=g.response)==null?void 0:a.data),C.value=((d=(n=(s=g.response)==null?void 0:s.data)==null?void 0:n.error)==null?void 0:d.message)||((h=(f=g.response)==null?void 0:f.data)==null?void 0:h.message)||"Failed to fetch cases",console.error("Error fetching cases:",g)}finally{i(!1)}};return{cases:l,currentCase:p,loading:x,error:C,totalCases:E,currentPage:I,pageSize:m,statusFilter:w,sortDirection:S,hasMorePages:A,inProgressCases:L,resolvedCases:M,clearError:y,getAllUserCases:F,getCaseById:async e=>{var u,r,t,c,o;i(!0),y();try{const s=(await D.getCaseById(e)).data;if(s)return p.value=s,s}catch(a){throw C.value=((t=(r=(u=a.response)==null?void 0:u.data)==null?void 0:r.error)==null?void 0:t.message)||((o=(c=a.response)==null?void 0:c.data)==null?void 0:o.message)||"Failed to fetch case details",console.error("Error fetching case:",a),a}finally{i(!1)}},createCase:async e=>{var u,r,t,c,o;i(!0),y();try{const s=(await D.createCase(e)).data;if(s)return l.value.unshift(s),E.value+=1,s}catch(a){throw C.value=((t=(r=(u=a.response)==null?void 0:u.data)==null?void 0:r.error)==null?void 0:t.message)||((o=(c=a.response)==null?void 0:c.data)==null?void 0:o.message)||"Failed to create case",console.error("Error creating case:",a),a}finally{i(!1)}},updateCase:async(e,u)=>{var r,t,c,o,a,s;i(!0),y();try{const d=(await D.updateCase(e,u)).data;if(d){const f=l.value.findIndex(h=>h.caseId===e);return f!==-1&&(l.value[f]=d),((r=p.value)==null?void 0:r.caseId)===e&&(p.value=d),d}}catch(n){throw C.value=((o=(c=(t=n.response)==null?void 0:t.data)==null?void 0:c.error)==null?void 0:o.message)||((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to update case",console.error("Error updating case:",n),n}finally{i(!1)}},updateCaseStatus:async(e,u)=>{var r,t,c,o,a,s;i(!0),y();try{const d=(await D.updateCaseStatus(e,u)).data;if(d){const f=l.value.findIndex(h=>h.caseId===e);return f!==-1&&(l.value[f]=d),((r=p.value)==null?void 0:r.caseId)===e&&(p.value=d),d}}catch(n){throw C.value=((o=(c=(t=n.response)==null?void 0:t.data)==null?void 0:c.error)==null?void 0:o.message)||((s=(a=n.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to update case status",console.error("Error updating case status:",n),n}finally{i(!1)}},loadMoreCases:async()=>{!A.value||x.value||await F(I.value+1,m.value,w.value,S.value,!1)},filterCasesByStatus:async e=>{await F(0,m.value,e,S.value,!0)},refreshCases:async()=>{await F(0,m.value,w.value,S.value,!0)},clearCurrentCase:()=>{p.value=null},clearCases:()=>{l.value=[],E.value=0,I.value=0,w.value=null}}});export{z as u};
