import{_ as j,u as O,f as l,k as D,l as I,c as n,b as e,m as u,t as c,w as q,i as y,v as A,g as h,a as z,p as E,F as $,r as U,s as H,x as L,y as Y,z as Z,o as a}from"./index-rvQoOiZL.js";import{a as b,s as k}from"./errorHandler-QDbb1r-H.js";const G={class:"auth-page"},J={class:"auth-container"},K={class:"auth-card"},Q={class:"auth-header"},W={class:"auth-title"},X={class:"auth-subtitle"},ee={class:"form-group"},se={class:"input-group"},te=["disabled"],oe={class:"form-actions"},re=["disabled"],ne={key:0,class:"loading-spinner"},ae={class:"form-group"},ie={class:"input-group"},le=["disabled"],de={key:0,class:"error-message"},ue={class:"form-group"},ce={class:"input-group"},we=["type","disabled"],pe=["disabled"],ve={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},he={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},me={key:0,class:"password-requirements"},fe={class:"requirements-list"},ge={class:"form-group"},ye={class:"input-group"},ke=["type","disabled"],_e=["disabled"],Pe={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},be={key:1,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},xe={key:0,class:"error-text"},Ce={class:"form-actions"},Ve=["disabled"],qe={key:0,class:"loading-spinner"},Ae={class:"verification-options"},Ee={class:"resend-text"},Me=["disabled"],Re={class:"auth-footer"},Se={key:0},Be={__name:"ForgotPasswordView",setup(Fe){const M=Z(),_=O(),r=l(!1),P=l(!1),d=l("request"),m=l(!1),f=l(!1),g=l([]),v=l(""),p=l(""),w=l(0),t=D({email:"",otp:"",newPassword:"",confirmPassword:""}),x=I(()=>d.value==="request"?t.email&&t.email.includes("@"):d.value==="reset"?t.otp&&t.otp.length===6&&t.newPassword&&t.confirmPassword&&g.value.length===0&&!v.value:!1),R=()=>{t.otp=t.otp.replace(/\D/g,"").slice(0,6)},S=()=>{const o=[];t.newPassword.length<8&&o.push("At least 8 characters long"),t.newPassword.length>100&&o.push("No more than 100 characters"),/(?=.*[a-z])/.test(t.newPassword)||o.push("At least one lowercase letter"),/(?=.*[A-Z])/.test(t.newPassword)||o.push("At least one uppercase letter"),/(?=.*\d)/.test(t.newPassword)||o.push("At least one number"),/[@#$%^&+=!*()_\-[\]{}|;:,.<>?]/.test(t.newPassword)||o.push("At least one special character (@ # $ % ^ & + = ! * ( ) _ - [ ] { } | ; : , . < > ?)"),/\s/.test(t.newPassword)&&o.push("No spaces allowed"),g.value=o,C()},C=()=>{t.confirmPassword&&t.newPassword!==t.confirmPassword?v.value="Passwords do not match":v.value=""},B=async()=>{r.value=!0;try{const o=await _.sendPasswordResetOTP(t.email);o.success?(b("Verification code sent to your email"),d.value="reset",V()):k(new Error(o.message||"Failed to send verification code"))}catch(o){console.error("Request OTP error:",o),k(o)}finally{r.value=!1}},F=async()=>{if(!(w.value>0)){P.value=!0;try{const o=await _.sendPasswordResetOTP(t.email);o.success?(b("Verification code resent to your email"),V()):k(new Error(o.message||"Failed to resend verification code"))}catch(o){console.error("Resend OTP error:",o),k(o)}finally{P.value=!1}}},V=()=>{w.value=60;const o=setInterval(()=>{w.value--,w.value<=0&&clearInterval(o)},1e3)},N=async()=>{if(!x.value){p.value="Please enter the complete verification code";return}r.value=!0,p.value="";try{const o={email:t.email,otp:t.otp,password:t.newPassword},s=await _.resetPassword(o);s.success?(b("Password reset successfully! You can now sign in with your new password."),M.push("/login")):p.value=s.message||"Failed to reset password"}catch(o){console.error("Reset password error:",o),p.value="An unexpected error occurred. Please try again."}finally{r.value=!1}};return(o,s)=>{const T=Y("router-link");return a(),n("div",G,[e("div",J,[e("div",K,[e("div",Q,[e("h1",W,c(d.value==="request"?"Forgot Password":"Reset Password"),1),e("p",X,c(d.value==="request"?"Enter your email to receive a verification code.":"Enter the verification code and your new password."),1)]),d.value==="request"?(a(),n("form",{key:0,class:"auth-form",onSubmit:q(B,["prevent"])},[e("div",ee,[s[7]||(s[7]=e("label",{for:"email"},"Email Address",-1)),e("div",se,[s[6]||(s[6]=e("span",{class:"input-icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"}),e("polyline",{points:"22,6 12,13 2,6"})])],-1)),y(e("input",{type:"email",id:"email","onUpdate:modelValue":s[0]||(s[0]=i=>t.email=i),required:"",placeholder:"e.g., name@example.com",disabled:r.value},null,8,te),[[A,t.email]])])]),e("div",oe,[e("button",{type:"submit",class:"btn btn-primary",disabled:r.value},[r.value?(a(),n("span",ne)):u("",!0),h(" "+c(r.value?"Sending...":"Send Verification Code"),1)],8,re)])],32)):u("",!0),d.value==="reset"?(a(),n("form",{key:1,class:"auth-form",onSubmit:q(N,["prevent"])},[e("div",ae,[s[9]||(s[9]=e("label",{for:"otp"},"Verification Code",-1)),e("div",ie,[s[8]||(s[8]=z('<span class="input-icon" data-v-9b53a3f3><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9b53a3f3><rect x="3" y="11" width="18" height="11" rx="2" ry="2" data-v-9b53a3f3></rect><circle cx="12" cy="16" r="1" data-v-9b53a3f3></circle><path d="M7 11V7a5 5 0 0 1 10 0v4" data-v-9b53a3f3></path></svg></span>',1)),y(e("input",{type:"text",id:"otp","onUpdate:modelValue":s[1]||(s[1]=i=>t.otp=i),required:"",maxlength:"6",placeholder:"Enter 6-digit code",disabled:r.value,onInput:R},null,40,le),[[A,t.otp]])]),s[10]||(s[10]=e("small",{class:"form-help"},"Enter the 6-digit code sent to your email",-1)),p.value?(a(),n("p",de,c(p.value),1)):u("",!0)]),e("div",ue,[s[15]||(s[15]=e("label",{for:"newPassword"},"New Password",-1)),e("div",ce,[s[13]||(s[13]=e("span",{class:"input-icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})])],-1)),y(e("input",{type:m.value?"text":"password",id:"newPassword","onUpdate:modelValue":s[2]||(s[2]=i=>t.newPassword=i),required:"",placeholder:"Enter new password",disabled:r.value,onInput:S},null,40,we),[[E,t.newPassword]]),e("button",{type:"button",class:"password-toggle",onClick:s[3]||(s[3]=i=>m.value=!m.value),disabled:r.value},[m.value?(a(),n("svg",ve,s[11]||(s[11]=[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(a(),n("svg",he,s[12]||(s[12]=[e("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),e("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])))],8,pe)]),g.value.length>0?(a(),n("div",me,[s[14]||(s[14]=e("small",{class:"error-text"},"Password must meet the following requirements:",-1)),e("ul",fe,[(a(!0),n($,null,U(g.value,i=>(a(),n("li",{key:i,class:"requirement-item"},c(i),1))),128))])])):u("",!0)]),e("div",ge,[s[19]||(s[19]=e("label",{for:"confirmPassword"},"Confirm New Password",-1)),e("div",ye,[s[18]||(s[18]=e("span",{class:"input-icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})])],-1)),y(e("input",{type:f.value?"text":"password",id:"confirmPassword","onUpdate:modelValue":s[4]||(s[4]=i=>t.confirmPassword=i),required:"",placeholder:"Confirm new password",disabled:r.value,onInput:C},null,40,ke),[[E,t.confirmPassword]]),e("button",{type:"button",class:"password-toggle",onClick:s[5]||(s[5]=i=>f.value=!f.value),disabled:r.value},[f.value?(a(),n("svg",Pe,s[16]||(s[16]=[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},null,-1),e("circle",{cx:"12",cy:"12",r:"3"},null,-1)]))):(a(),n("svg",be,s[17]||(s[17]=[e("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},null,-1),e("line",{x1:"1",y1:"1",x2:"23",y2:"23"},null,-1)])))],8,_e)]),v.value?(a(),n("small",xe,c(v.value),1)):u("",!0)]),e("div",Ce,[e("button",{type:"submit",class:"btn btn-primary",disabled:r.value||!x.value},[r.value?(a(),n("span",qe)):u("",!0),h(" "+c(r.value?"Resetting...":"Reset Password"),1)],8,Ve)]),e("div",Ae,[e("p",Ee,[s[20]||(s[20]=h(" Didn't receive the code? ")),e("button",{onClick:F,class:"resend-link",disabled:P.value||w.value>0},c(w.value>0?`Resend in ${w.value}s`:"Resend Code"),9,Me)])])],32)):u("",!0),e("div",Re,[d.value==="request"?(a(),n("p",Se,[s[22]||(s[22]=h(" Remember your password? ")),H(T,{to:"/login",class:"link font-weight-bold"},{default:L(()=>s[21]||(s[21]=[h("Sign in")])),_:1,__:[21]})])):u("",!0)])])])])}}},je=j(Be,[["__scopeId","data-v-9b53a3f3"]]);export{je as default};
