import{_ as C,l as T,c as n,o,b as e,a1 as x,t as u,f as $,i as z,v as E,X as F,F as S,r as B,a0 as K,A as R,n as w,C as i,m as _,s as N,d as L,x as j}from"./index-rvQoOiZL.js";import{u as O}from"./blog-Dy399Syj.js";const Q={class:"blog-card"},X={class:"blog-main"},Y={class:"title"},q={class:"meta"},G={class:"author"},J={class:"timestamp"},W={class:"excerpt"},Z={class:"actions"},ee={__name:"BlogCard",props:{blog:{type:Object,required:!0},subscribed:{type:Boolean,default:!1},excerptLength:{type:Number,default:220}},setup(b){const g=b,h=T(()=>{const s=document.createElement("div");s.innerHTML=g.blog.content||"";const l=s.textContent||s.innerText||"";return l.length<=g.excerptLength?l:l.slice(0,g.excerptLength)+"â€¦"});function c(s){try{return new Date(s).toLocaleString()}catch{return s}}return(s,l)=>(o(),n("div",Q,[e("div",X,[e("h3",Y,u(b.blog.title),1),e("div",q,[e("span",G,"By "+u(b.blog.author.firstName)+" "+u(b.blog.author.lastName),1),e("span",J,"Updated: "+u(c(b.blog.updatedAt)),1)]),e("p",W,u(h.value),1),x(s.$slots,"default",{},void 0)]),e("div",Z,[x(s.$slots,"actions",{},()=>[e("button",{class:"btn btn-outline btn-sm",onClick:l[0]||(l[0]=m=>s.$emit("view",b.blog.blogId))}," View ")])])]))}},I=C(ee,[["__scopeId","data-v-4d4eab3f"]]),te={class:"search-bar"},se={__name:"BlogSearchBar",emits:["search"],setup(b,{emit:g}){const h=g,c=$("");function s(){h("search",c.value.trim())}return(l,m)=>(o(),n("div",te,[z(e("input",{"onUpdate:modelValue":m[0]||(m[0]=d=>c.value=d),type:"text",class:"search-input",placeholder:"Search law insights (title, content)",onKeyup:F(s,["enter"])},null,544),[[E,c.value]]),e("button",{class:"btn btn-outline",onClick:s},"Search")]))}},ae=C(se,[["__scopeId","data-v-c21119f6"]]),oe={key:0,class:"subs-list"},ne={class:"avatar"},ie={class:"info"},le={class:"name"},re={class:"email"},ue=["onClick"],ce={key:1,class:"empty-state"},de={__name:"SubscriptionsList",props:{authors:{type:Array,default:()=>[]}},setup(b){function g(h,c){return`${(h||"")[0]||""}${(c||"")[0]||""}`.toUpperCase()}return(h,c)=>{var s;return(s=b.authors)!=null&&s.length?(o(),n("div",oe,[(o(!0),n(S,null,B(b.authors,l=>(o(),n("div",{class:"sub-item",key:l.email},[e("div",ne,u(g(l.firstName,l.lastName)),1),e("div",ie,[e("div",le,u(l.firstName)+" "+u(l.lastName),1),e("div",re,u(l.email),1)]),c[0]||(c[0]=e("div",{class:"spacer"},null,-1)),e("button",{class:"btn btn-outline btn-sm",onClick:m=>h.$emit("unsubscribe",l)},"Unsubscribe",8,ue)]))),128))])):(o(),n("div",ce,"You haven't subscribed to any author yet."))}}},be=C(de,[["__scopeId","data-v-09faefb2"]]),ge={class:"insights-container"},ve={class:"tabs"},he={class:"content"},pe={key:0,class:"loading"},_e={key:0},me={key:0,class:"empty-state"},fe={key:1,class:"blog-list"},ye={key:2,class:"pagination"},ke=["disabled"],$e=["disabled"],Se={key:1},Ce={class:"search-controls"},we={key:0,class:"empty-state"},Be={key:1,class:"blog-list"},Pe=["innerHTML"],xe=["innerHTML"],Ne={key:2,class:"pagination"},Le=["disabled"],Ie=["disabled"],Te={key:2},Me={key:0,class:"pagination"},Ve=["disabled"],Ue=["disabled"],Ae={__name:"LawInsightsView",setup(b){const g=O(),{isLoading:h,subscribedBlogs:c,subscribedBlogsPage:s,hasSubscribedBlogs:l,searchResults:m,searchPage:d}=K(g),{loadSubscribedBlogs:M,searchPublishedBlogs:V,unsubscribeFromAuthor:U}=g,p=$("subscribed"),f=$(""),A=T(()=>{const r=new Map;for(const t of c.value||[]){const a=t.author;a&&!r.has(a.id)&&r.set(a.id,{id:a.id,firstName:a.firstName,lastName:a.lastName,email:a.email})}return Array.from(r.values())}),v=$({page:0,size:10,total:0,totalPages:1});R(()=>{y(0)});function y(r){M(r,s.value.size,s.value.sortDirection)}function D(r){f.value=r,k(r,0)}function k(r,t){r&&V(r,t,d.value.size)}function P(r){const t=`/blog/${r}`;window.open(t,"_blank")}async function H(r){try{await U(r.id||r.userId),y(0),f.value&&k(f.value,d.value.page)}catch(t){console.error(t)}}return(r,t)=>(o(),n("div",ge,[t[11]||(t[11]=e("div",{class:"header"},[e("div",{class:"header-left"},[e("h1",null,"Law Insights"),e("p",{class:"subtitle"},"Explore legal blogs from lawyers. Subscribe to authors you like.")])],-1)),e("div",ve,[e("button",{onClick:t[0]||(t[0]=a=>p.value="subscribed"),class:w(["tab",{active:p.value==="subscribed"}])},"Subscribed Blogs",2),e("button",{onClick:t[1]||(t[1]=a=>p.value="search"),class:w(["tab",{active:p.value==="search"}])},"Search",2),e("button",{onClick:t[2]||(t[2]=a=>p.value="authors"),class:w(["tab",{active:p.value==="authors"}])},"My Subscriptions",2)]),e("div",he,[i(h)?(o(),n("div",pe,"Loading...")):(o(),n(S,{key:1},[p.value==="subscribed"?(o(),n("div",_e,[i(l)?(o(),n("div",fe,[(o(!0),n(S,null,B(i(c),a=>(o(),L(I,{key:a.blogId,blog:a,onView:P},null,8,["blog"]))),128))])):(o(),n("div",me,t[9]||(t[9]=[e("p",null,"No subscribed blogs yet. Use Search to find authors and subscribe.",-1)]))),i(s).totalPages>1?(o(),n("div",ye,[e("button",{class:"btn btn-outline",disabled:i(s).page===0,onClick:t[3]||(t[3]=a=>y(i(s).page-1))},"Prev",8,ke),e("span",null,"Page "+u(i(s).page+1)+" / "+u(i(s).totalPages),1),e("button",{class:"btn btn-outline",disabled:i(s).page>=i(s).totalPages-1,onClick:t[4]||(t[4]=a=>y(i(s).page+1))},"Next",8,$e)])):_("",!0)])):_("",!0),p.value==="search"?(o(),n("div",Se,[e("div",Ce,[N(ae,{onSearch:D})]),i(m).length===0?(o(),n("div",we,t[10]||(t[10]=[e("p",null,"Search to discover published blogs from lawyers.",-1)]))):(o(),n("div",Be,[(o(!0),n(S,null,B(i(m),a=>(o(),L(I,{key:a.blog.blogId,blog:a.blog,onView:P},{default:j(()=>[a.highlightedTitle?(o(),n("div",{key:0,class:"highlight",innerHTML:a.highlightedTitle},null,8,Pe)):_("",!0),a.highlightedContent?(o(),n("div",{key:1,class:"highlight",innerHTML:a.highlightedContent},null,8,xe)):_("",!0)]),_:2},1032,["blog"]))),128))])),i(d).totalPages>1?(o(),n("div",Ne,[e("button",{class:"btn btn-outline",disabled:i(d).page===0,onClick:t[5]||(t[5]=a=>k(f.value,i(d).page-1))},"Prev",8,Le),e("span",null,"Page "+u(i(d).page+1)+" / "+u(i(d).totalPages),1),e("button",{class:"btn btn-outline",disabled:i(d).page>=i(d).totalPages-1,onClick:t[6]||(t[6]=a=>k(f.value,i(d).page+1))},"Next",8,Ie)])):_("",!0)])):_("",!0),p.value==="authors"?(o(),n("div",Te,[N(be,{authors:A.value,onUnsubscribe:H},null,8,["authors"]),v.value.totalPages>1?(o(),n("div",Me,[e("button",{class:"btn btn-outline",disabled:v.value.page===0,onClick:t[7]||(t[7]=a=>v.value.page=v.value.page-1)},"Prev",8,Ve),e("span",null,"Page "+u(v.value.page+1)+" / "+u(v.value.totalPages),1),e("button",{class:"btn btn-outline",disabled:v.value.page>=v.value.totalPages-1,onClick:t[8]||(t[8]=a=>v.value.page=v.value.page+1)},"Next",8,Ue)])):_("",!0)])):_("",!0)],64))])]))}},ze=C(Ae,[["__scopeId","data-v-e839d1e7"]]);export{ze as default};
